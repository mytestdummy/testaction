name: 'Testaction'
author: 'Sitdisch'
description: 'Test your action'
inputs:
  new-first-commit:
    description: 'New first commit (commit-hash | HEAD~N etc.)'
    required: true
  branch:
    description: 'Branch to be pruned'
    required: true
    default: 'master'
runs:
  using: "composite"
  steps:
    - run: |
        git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
        git config --local user.name "github-actions[bot]"
        COMMIT_MESSAGE=$(git log --format=%B -n 1 ${{ inputs.new-first-commit }})" [ Test[bot]: Earlier Commits Cleaned ]"
        
        git checkout --orphan test_temp ${{ inputs.new-first-commit }}
        git commit -m "$COMMIT_MESSAGE"
        git rebase --onto test_temp ${{ inputs.new-first-commit }} ${{ github.event.inputs.branch }}
        git branch -D test_temp
        git push origin HEAD --force
      shell: bash
